<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org/">

<head class="head">
    <title>Выдача-смета</title>
    <div th:replace="fragments/head :: header"></div>

    <!-- <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
      <meta name="robots" content="index, follow">
      <meta name="author" content="">
      <meta property="og:url" content="https://site.ru">
      <meta property="og:title" content="MAD DOG">
      <meta property="og:image:type" content="image/jpeg">
      <meta property="og:image:width" content="640">
      <meta property="og:image:height" content="442">
      <meta property="og:description" content="">
      <meta property="og:site_name" content="Site-name">

      <link rel="apple-touch-icon" sizes="57x57" href="https://lk.rentinhand.ru/img/icons/apple-icon-57x57.png">
      <link rel="apple-touch-icon" sizes="60x60" href="https://lk.rentinhand.ru/img/icons/apple-icon-60x60.png">
      <link rel="apple-touch-icon" sizes="72x72" href="https://lk.rentinhand.ru/img/icons/apple-icon-72x72.png">
      <link rel="apple-touch-icon" sizes="76x76" href="https://lk.rentinhand.ru/img/icons/apple-icon-76x76.png">
      <link rel="apple-touch-icon" sizes="114x114" href="https://lk.rentinhand.ru/img/icons/apple-icon-114x114.png">
      <link rel="apple-touch-icon" sizes="120x120" href="https://lk.rentinhand.ru/img/icons/apple-icon-120x120.png">
      <link rel="apple-touch-icon" sizes="144x144" href="https://lk.rentinhand.ru/img/icons/apple-icon-144x144.png">
      <link rel="apple-touch-icon" sizes="152x152" href="https://lk.rentinhand.ru/img/icons/apple-icon-152x152.png">
      <link rel="apple-touch-icon" sizes="180x180" href="https://lk.rentinhand.ru/img/icons/apple-icon-180x180.png">
      <link rel="icon" type="image/png" sizes="192x192"
      href="https://lk.rentinhand.ru/img/icons/android-icon-192x192.png">
      <link rel="icon" type="image/png" sizes="32x32" href="https://lk.rentinhand.ru/img/icons/favicon-32x32.png">
      <link rel="icon" type="image/png" sizes="96x96" href="https://lk.rentinhand.ru/img/icons/favicon-96x96.png">
      <link rel="icon" type="image/png" sizes="16x16" href="https://lk.rentinhand.ru/img/icons/favicon-16x16.png">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="author" content="Andrey">
      <meta name="description" content="MAD DOG">
      <meta name="keywords" content="MAD DOG">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta property="og:title" content="MAD DOG - сервис для учета и автоматизации проката">
      <meta property="og:image" content="assets/img/icons/badge.jpg" th:src="@{/img/icons/badge.jpg}">
      <meta property="og:image:type" content="image/jpeg">
      <meta property="og:image:width" content="1024">
      <meta property="og:image:height" content="1024">
      <meta property="og:description" content="Программа для учёта инструментов">
      <link rel="image_src" href="/static/img/icons/badge.jpg" th:href="@{/img/icons/badge.jpg}">
      <meta name="theme-color" content="#179d82">
      <meta th:name="_csrf" th:content="${_csrf.token}"/>
      <meta th:name="_csrf_header" th:content="${_csrf.headerName}"/>
     

      <link rel="preload" href="../static/fonts/fontawesome/fontawesome-all-css.css" as="style" th:href="@{/fonts/fontawesome/fontawesome-all-css.css}">
      <link rel="preload" href="../static/css/style.css" as="style" th:href="@{/css/style.css}">
      <link rel="preload" href="../static/css/app.css" as="style" th:href="@{/css/app.css}">
      <link rel="preload" href="../static/css/media.css" as="style" th:href="@{/css/media.css}">
      <link rel="preload" href="../static/css/checkout.css" as="style" th:href="@{/css/checkout.css}">
      <link rel="preload" href="../static/css/main.css" as="style" th:href="@{/css/main.css}">


      <link rel="stylesheet" href="../static/fonts/webfonts/fa-solid-900.ttf" th:href="@{/fonts/webfonts/fa-solid-900.ttf}">
      <link rel="stylesheet" href="../static/css/style.css" th:href="@{/css/style.css}">
      <link rel="stylesheet" href="../static/css/app.css" th:href="@{/css/app.css}">
      <link rel="stylesheet" href="../static/css/media.css" th:href="@{/css/media.css}">
      <link rel="stylesheet" href="../static/css/animation-iror.css" th:href="@{/css/animation-iror.css}">
      <link rel="stylesheet" href="../static/fonts/fontawesome/fontawesome.css" th:href="@{/fonts/fontawesome/fontawesome.css}">
      <link rel="stylesheet" href="../static/fonts/fontawesome/fontawesome-all-css.css" th:href="@{/fonts/fontawesome/fontawesome-all-css.css}">
      <link rel="stylesheet" href="../static/css/checkout.css" th:href="@{/css/checkout.css}">
      <link rel="stylesheet" href="../static/css/main.css" th:href="@{/css/main.css}">
      
      <script src="/static/fonts/fontawesome/all.js" th:src="@{/fonts/fontawesome/all.js}"></script>
     
      <script src="/static/js/jquery.js" th:src="@{/js/jquery.js}"></script>
     
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"  th:src="@{/js/jquery.modal.js}"></script>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" th:href="@{/css/jquery.modal.css}" /> -->
</head>

<body class="fixed-sidebar pace-done fixed-nav fixed-nav-basic curent-page">
<div class="b-overlay-wrap position-relative w-100" size="sm" id="wrapper">
    <div class="b-overlay-wrap position-relative w-100" size="sm">
        <div th:insert="fragments/menu_sidebar.html"></div>
        <div class="b-overlay-wrap position-relative w-100" size="sm">
            <div class="rih-page-wrapper">
                <nav role="navigation" class="navbar navbar-admin navbar-fixed-top"
                     th:insert="fragments/header_logout.html"></nav>
                <main class="wrapper wrapper-content border-bottom">
                    <!-- <div class="btn-pimary__groups-wrapper col-12 mb-3">
                         <div class="mb-3 text-right">
                             <span class="btn-pimary__groups_title">Смета</span>
                         </div>
                         <div class="mb-3 text-right">
                             <a href="/projects/create" class="btn btn-primary min-width-120 btn-add_vidacha grey">Назад</a>
                         </div>
                         <div class="mb-3 text-right">
                             <button href="#" class="btn btn-primary min-width-120 green">Сохранить</button>
                         </div>
                         <div class="mb-3 text-right">
                             <button href="#" class="btn btn-primary min-width-120 yellow">Сохранить и закрыть</button>
                         </div>
                         <div class="mb-3 text-right">
                             <button href="#" class="btn btn-primary min-width-120 light-grey ">Печать</button>
                         </div>
                         <div class="mb-3 text-right">
                             <button href="#" class="btn btn-primary min-width-120 light-blue">Калькулятор</button>
                         </div>
                         <div class="mb-3 text-right">
                             <button href="/tools" class="btn btn-primary min-width-120 green">Добавить оборудование и обслуживание</button>
                         </div>
                     </div>-->
                    <div class="b-overlay-wrap position-relative custom-ll">
                        <div class="row">
                            <!--<div class="btn__under-table col-lg-12 order-lg-1">
                                <div class="mb-3 text-right">
                                    <a href="#" class="btn btn-primary min-width-120 grey">Без скидки</a>
                                </div>
                                <div class="mb-3 text-right">
                                    <a href="#" class="btn btn-primary min-width-120 grey">Скидка на оборудование</a>
                                </div>
                                <div class="mb-3 text-right">
                                    <a href="#" class="btn btn-primary min-width-120 grey">Скидка по каждому оборудованию</a>
                                </div>
                                <div class="mb-3 text-right">
                                    <a href="#" class="btn btn-primary min-width-120 grey">Расчет скидки из суммы по проекту</a>
                                </div>
                                <div class="mb-3 text-right">
                                    <a href="#" class="btn btn-primary min-width-120 grey">Расчет скидки из суммы с УСН</a>
                                </div>
                            </div>-->
                            <div class="custom-ll__table table-responsive overflow-auto col-lg-12 order-lg-1">
                                <table class="estimate table w-table">
                                    <tbody>
                                    <tr>
                                        <td rowspan="9" class="first-th"></td>
                                        <td rowspan="7"><img class="table-logo" th:src="@{/img/logo/mad-dog-logo.png}">
                                        </td>
                                        <th colspan="2" rowspan="2">Съемочный период:</th>
                                        <td colspan="4"><span class="table-td-text" th:field="*{start}"
                                                              th:value="${estimate.start}"
                                                              th:text="${#temporals.format(estimate.start, 'dd-MM-yyyy HH:mm')}">Подстановка даты начала проекта</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="4"><span class="table-td-text" th:field="*{end}"
                                                              th:value="${estimate.end}"
                                                              th:text="${#temporals.format(estimate.end, 'dd-MM-yyyy HH:mm')}">Подстановка даты окончания проекта</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th colspan="3">Количество смен:</th>
                                        <td colspan="3"><span class="table-td-text" th:text="${estimate.count_shifts}">Посчет исходя из дат проекта</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>Проект:</th>
                                        <td colspan="5">
                                            <span class="table-td-text" th:text="${estimate.project.name}">Подстановка названия проекта</span>
                                            <input type="text" hidden="hidden" th:value="${estimate.id}"
                                                   class="estimate_id_value">
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>Оператор:</th>
                                        <td colspan="5"><span class="table-td-text"
                                                              th:text="${estimate.project.client.directorOfPhotography}">Постановка из карточки клиента</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>Заказчик:</th>
                                        <td colspan="5"><span class="table-td-text"
                                                              th:text="${estimate.project.client.fullName}">Постановка из карточки клиента</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>Менеджер:</th>
                                        <td colspan="5"><span class="table-td-text"
                                                              th:text="${estimate.project.employee}">ФИО сотрудника из аккаунта</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th rowspan="2">Наименование оборудования</th>
                                        <th rowspan="2">Стоимость</th>
                                        <th colspan="3">Количество</th>
                                        <th rowspan="2">Итого за смену</th>
                                        <th rowspan="2">Итого за проект</th>
                                    </tr>
                                    <tr>
                                        <th>Ед.техники</th>
                                        <th>Дней</th>
                                        <th>Скидка</th>
                                    </tr>
                                    <!-- Выбока данных -->
                                    <div id="data-form-send" th:each="list_tools: ${map_tools}">
                                        <div th:with="key = ${list_tools.key}">
                                            <tr th:if="${key.toString()!='SERVICE'}">
                                                <td class="first-th"></td>
                                                <th colspan="7" th:utext="${list_tools.key.getValue()}"></th>
                                            </tr>
                                        </div>
                                        <tr th:each="tool :${list_tools.value}">
                                            <div th:unless="${tool.section.toString()=='SERVICE'}">
                                                <td>
                                                    <input class="item_id" type="hidden" th:value="${tool.id}">
                                                    <input class="item_category" type="hidden"
                                                           th:value="${list_tools.key}">
                                                </td>
                                                <td><span class="table-td-text" th:value="${tool.name}"
                                                          th:utext="${tool.name}" ></span></td>
                                                <td><input required="" th:value="${tool.priceByDay}" type="text"
                                                           class="form-control__table fIn1"
                                                           oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');"
                                                           placeholder="Цена за сутки"></td>
                                                <td><input class="form-control__table fIn2" type="text"
                                                           th:value="${tool.amount}" placeholder="Количество"
                                                           oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');">
                                                </td>
                                                <td><input required="" th:value="${tool.countShifts}" type="text"
                                                           class="form-control__table fIn3"
                                                           oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');"
                                                           placeholder="Количество смен"></td>
                                                <td><input type="text" th:value="${tool.discount}"
                                                           class="form-control__table fIn4"
                                                           placeholder="Скидка"></td>
                                                <td><span class="table-td-text fIn5"></span>
                                                </td>
                                                <td><span class="table-td-text fIn6"></span>
                                                </td>
                                            </div>
                                        </tr>
                                    </div>
                                    <tr>
                                        <td rowspan="4" class="first-th"></td>
                                        <th colspan="3">Всего по проекту:</th>
                                        <td colspan="4"><span class="table-td-text "><input required="" type="text"
                                                                                            class="form-control__table fsIn1"
                                                                                            oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');"
                                                                                            placeholder="Сумма итого по оборудованию"></span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th colspan="3">Скидка на оборудование:(%)</th>
                                        <td colspan="4"><span class="table-td-text"><input required="" type="text"
                                                                                           class="form-control__table fsIn2"
                                                                                           oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');"
                                                                                           placeholder="Постановка суммы клиента/расчет из суммы УСН"></span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th colspan="3">Всего по проекту с учетом скидки:</th>
                                        <td colspan="4"><span class="table-td-text"><input required="" type="text"
                                                                                           class="form-control__table fsIn3"
                                                                                           oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');"
                                                                                           placeholder="Сумма итого по оборудованию*(100 на комплект)/100"></span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="8"></td>
                                    </tr>
                                    <tr>
                                        <td class="first-th add_transport"
                                            style="cursor: pointer; background: #1ab394; color: #fff; font-size: 20px;">
                                            +
                                        </td>
                                        <th colspan="7" class="sat">Обслуживание и транспорт</th>
                                    </tr>
                                    <div th:each="list_tools: ${map_tools}">
                                        <tr class="sat_item" th:each="tool :${list_tools.value}">
                                            <div th:unless="${tool.section.toString()!='SERVICE'}">
                                                <td class="first-th remove_transport"
                                                    style="cursor: pointer; background: #1ab394; color: #fff; font-size: 20px;">
                                                    -
                                                </td>
                                                <td><input type="text" class="form-control__table fIn0_t"
                                                           th:value="${tool.name}"
                                                           style="font-size: 14px;" placeholder="Наименование"></td>
                                                <td><input th:value="${tool.priceByDay}" type="text" class="form-control__table fIn1_t"
                                                           placeholder="Цена за смену"></td>
                                                <td><input th:value="${tool.amount}" type="text" class="form-control__table fIn2_t"
                                                           placeholder="Количество"></td>
                                                <td><input th:value="${tool.countShifts}" type="text" class="form-control__table fIn3_t"
                                                           placeholder="Количество смен"></td>
                                                <td><input type="text" th:value="${tool.discount}" class="form-control__table fIn4_t"
                                                           placeholder="Скидка"></td>
                                                <td><span class="table-td-text fIn5_t"></span></td>
                                                <td><span class="table-td-text fIn6_t"></span></td>
                                            </div>
                                        </tr>
                                    </div>
                                    <tr>
                                        <td class="first-th"></td>
                                        <th colspan="3">Всего по обслуживанию и транспорту:</th>
                                        <td colspan="4"><span class="table-td-text "><input required="" type="text"
                                                                                            class="form-control__table fsIn1_t"
                                                                                            oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');"
                                                                                            placeholder="Сумма итого по ослуживанию"></span>
                                        </td>
                                    </tr>


                                    <tr>
                                        <td class="first-th"></td>
                                        <th colspan="3">Итоговая сумма по проекту:</th>
                                        <td colspan="4"><span class="table-td-text"><input required="" type="text"
                                                                                           class="form-control__table fsIn2_t"
                                                                                           oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');"
                                                                                           placeholder="Сумма итого по оборудованию + Сумма итого по ослуживанию"></span>
                                        </td>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="first-th"></td>
                                        <th colspan="3">Процент УСН (%):</th>
                                        <td colspan="4"><span class="table-td-text"><input required="" type="text"
                                                                                           class="form-control__table fsIn3_USN_t"
                                                                                           oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');"
                                                                                           placeholder="Процент УСН (%)"></span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="first-th"></td>
                                        <th colspan="3">Итоговая сумма УСН:</th>
                                        <td colspan="4"><span class="table-td-text"><input required="" type="text"
                                                                                           class="form-control__table fsIn3_t"
                                                                                           oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');"
                                                                                           placeholder="Итоговая сумма по проекту/0.91/Ручной ввод"></span>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                                <div class="mt-4 mb-4 col-4 save-btn">
                                    <button type="submit" id="save_estimate"
                                            class="btn btn-lg btn-primary btn-primary_save w-100">
                                        Сохранить смету
                                    </button>
                                </div>
                                <div class="mt-4 mb-4 col-4 save-btn">
                                    <button type="submit" id="estimate_load_file"
                                            class="btn btn-lg btn-primary btn-primary_save w-100">
                                        Выгрузить
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="pagination-control col-lg-12 order-lg-1">
                        <!-- Bootstrap 4 -->
                        <nav aria-label="Навигация по страницам">
                            <ul class="pagination">
                                <li class="page-item" th:if="${list_tools.totalPages > 0}"
                                    th:each="page_number : ${page_numbers}">
                                    <a class="page-link-m page-link"
                                       th:href="@{/tools(size=${list_tools.size}, page=${page_numberStat.index})}"
                                       th:text="${page_numberStat.index}"
                                       th:class="${page_number==list_tools.number + 1} ? active"></a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                </main>
                <div th:insert="fragments/footer.html"></div>
            </div>
        </div>
    </div>
</div>
<div th:insert="fragments/scripts.html"></div>
</body>

</html>